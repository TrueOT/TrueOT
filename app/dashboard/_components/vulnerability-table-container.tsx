import { VulnerabilityTable } from "./vulnerability-table";
import { prisma } from "../../../lib/db/prisma";
import { VulnerabilityAnalysis } from '@prisma/client';

async function getVulnerabilityData(): Promise<VulnerabilityAnalysis[]> {
  try {
    // Fetch vulnerabilities directly from the database
    return await prisma.vulnerabilityAnalysis.findMany();
  } catch (error) {
    console.error('Error fetching vulnerability data:', error);
    return [];
  }
}

export async function VulnerabilityTableContainer() {
  const vulnerabilities = await getVulnerabilityData();
  
  return <VulnerabilityTable initialVulnerabilities={vulnerabilities} />;
} 